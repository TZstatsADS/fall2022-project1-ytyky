---
title: "The Impact of Thoughts"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
```



```{r}
packages.used=c("rvest", "tibble", 
                "sentimentr", "gplots", "dplyr",
                "tm", "syuzhet", "factoextra", 
                "beeswarm", "scales", "RColorBrewer",
                "RANN", "topicmodels", "stringr")
# check packages that need to be installed.
packages.needed=setdiff(packages.used, 
                        intersect(installed.packages()[,1], 
                                  packages.used))
# install additional packages
if(length(packages.needed)>0){
  install.packages(packages.needed, dependencies = TRUE)
}
library(ggplot2)
library(dplyr)
library(redav)
library(textmineR)
library(ggalluvial)
library(wordcloud)
library(RColorBrewer)
library(wordcloud2)
library(tm)
library(knitr)
library(tidytext)
```


```{r}
philosophy_data <- read.csv("../data/philosophy_data.csv")
```


## Intro

Philosophers provide a way to think about the world systematically. Their works influence many people potentially, providing methodology and useful tips for life. Some of their thoughts are coincided, some are conflicted. One question raised naturally: when they develop their works, are they inspired by other philosopher in some way? In another word, how philosophers influence their colleagues and the history of philosophy?

In this project we dive into the corpus philosophers wrote and research on the influence of philosopher. We would approach this question with data mining techniques and try to quantify and visualize their influence by examining the history of philosophy dataset from [Philosophy Data Project](http://www.philosophydata.com/), figure out the influence of philosophers' words though history.



## Looking into the dataset

In order to get a better sense of the dataset we are analyzing, we first take a glimpse on the dataset.

### Column Details

* title
* author
* school
* sentence_spacy
* sentence_str
* original_publication_date
* corpus_edition_date
* sentence_length
* sentence_lowered
* tokenized_txt
* lemmatized_str

The dataset is pre-processed and each row contains one sentence and school, author, and other information.

### missing values

```{r, warning=FALSE}
missing_philosophy_data_show_case <- philosophy_data %>% 
  select(title, author,school, sentence_str, original_publication_date) %>%
  rename(date = original_publication_date)
plot_missing(missing_philosophy_data_show_case)
```

There is no missing values, and total contains 360808 complete sentences.We then check how many unique authors, titles and schools collected in the dataset.

```{r}
unique_data <- data.frame(uniqe_stat=sapply(philosophy_data, function(x) n_distinct(x)))
unique_data <- cbind(unique_data,rownames(unique_data))
unique_data <- unique_data %>% rename(information = `rownames(unique_data)`)
rownames(unique_data) <- NULL
copurs_info <- unique_data %>% filter(information %in% c('school', 'author',  'title'))
ggplot(data=copurs_info, aes(x=information, y=uniqe_stat)) + 
  geom_bar(stat="identity") +
  xlab("information") + 
  ylab("distinct values")
  ggtitle("copurs information statitsics")
```

Only 13 school and 36 distinct philosophers recorded and in total they create 55 corpus and over 360,000 sentences. 

Assumption is philosophers under same school could influence each other a lot.

## Influence Analysis

To find influence of a philosopher, we can dive into the corpus and find connections. 

It is firstly reasonable to speculate that if one philosopher mention another philosopher directly in their own corpus, then he/she is impacted by the philosopher. At this stage we can count the author name in all texts

```{r}
philosopher = unique(philosophy_data['author'])
occurance = rep(0, nrow(philosopher))
direct_citation <- data.frame(philosopher, occurance)
for (i in 1:nrow(philosopher)) {
    # find direct citation, exclude self-cited corpus
    direct_citation[i,2] = sum(grepl(tolower(direct_citation[i,1]), (philosophy_data %>% filter(!author %in%c(direct_citation[i,1])))$sentence_lowered))
}
rownames(direct_citation) <- 1:nrow(direct_citation)
```

```{r}
p<-ggplot(data=top_n(direct_citation, 10), aes(x=reorder(author, -occurance), y=occurance)) +
  geom_bar(stat="identity") +
  xlab("philosopher") + 
  ggtitle("top 10 philosophers mentioned directly in corpus")
p
```
Here we plot top 10 philosophers' name. Intuitively, ancient philosophers should have higher chance to be cited in corpus. Surprisingly, the top 3 authors mentioned in corpus are not ancient Greek philosophers such as Plato and Aristotle. Instead, Kant, Descartes and Russell are the top 3 directed recorded philosophers in history of philosophy. We could further investigate what lead to this situation by examine the correlation between philosophers' occurrence in corpus and other potential factors such as their corpus length, time period they lived etc.

```{r}
citation_factors <- philosophy_data %>% group_by(author, school) %>% summarise(total_length = sum(sentence_length), time_period = mean(original_publication_date))
```

```{r}
citation <- merge(direct_citation, citation_factors, by.x = "author", 
             by.y = "author", all.x = TRUE, all.y = FALSE)
```



```{r}
kruskal.test(occurance ~ school, data = citation)
kruskal.test(occurance ~ time_period, data = citation)
kruskal.test(occurance ~ total_length, data = citation)
```

The three KW test suggested all have quite big p-values, which implies the reputations of philosophers are uncorrelated with their publications' length, school they are in, and the time period they lived.

### school

We could then cluster the philosophers by schools, find their school influence by capturing occurrence of their school in philosophy corpus

```{r}
school = unique(philosophy_data['school'])
occurance = rep(0, nrow(school))
school_reputation <- data.frame(school, occurance)
for (i in 1:nrow(school)) {
    # find direct citation, exclude self-cited corpus
    school_reputation[i,2] = sum(grepl(tolower(school_reputation[i,1]), (philosophy_data %>% filter(!school %in%c(school_reputation[i,1])))$sentence_lowered))
}
```

```{r}
p2<-ggplot(data=school_reputation, aes(x=reorder(school, -occurance), y=occurance)) +
  geom_bar(stat="identity") +
  xlab("school") + 
  ggtitle("school reputation")
p2
```

From the graph we observed that analytic school has high frequency in other school's corpus. German idealism, which Kant belongs to, surprisingly was the least mentioned school (actually, 0 time appeared in other corpus).


### Corpus

Partition over the whole dataset we could find topics that are discuss among all philosophy corpus. We could therefore create a wordcloud that visualize the high frequency words among all corpus


```{r}
text <- philosophy_data$tokenized_txt
docs <- Corpus(VectorSource(text))
docs <- docs %>% tm_map(removeWords, stopwords("english")) %>%
  tm_map(removePunctuation)
dtm <- TermDocumentMatrix(docs)
tdm.tidy=tidy(dtm)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
```

```{r, fig.height=6, fig.width=6}
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
          scale=c(10,5),
          max.words=100,
          min.freq=50,
          random.order=FALSE,
          rot.per=0.3,
          random.color=FALSE,
          colors=brewer.pal(20,"Blues"))
```

From the word cloud there we can observe that the high frequency words are pretty simple and the texts pattern aren't vary a lot. It is hard to observe the influence of any philosopher in this method. We can further investigate the distribution of copurs via a alluvial graph, observe what the author and school each corpus belongs to.

```{r}
df1 <- philosophy_data %>% select(c('author', 'school', 'sentence_length', 'title', 'original_publication_date')) %>% group_by(title, author, school) %>% summarise(copurs_length = sum(sentence_length))

colourCount <- length(unique(df1$school)) # number of levels
getPalette <- colorRampPalette(brewer.pal(9, "Set1"))

ggplot(as.data.frame(df1),
       aes(y = copurs_length, axis1 = author, axis2 = title)) +
  geom_alluvium(aes(fill = school), width = 1/6) +
  geom_stratum(width = 1/6, fill = "black", color = "grey") +
  #geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("author", "title"), expand = c(.05, .05)) +
  scale_fill_brewer(type = "qual", palette = "Set3") +
  ylab('corpus length by sentences') +
  ggtitle("school information of published corpus by, author and title")
```




## Conclusion

After analysis from 3 different perspective we can get a sense of the position of philosophers in the history. Kant as a philosopher is the top philosopher directly named in other authors' corpus, but his school, german idealism is not so famous and not even mentioned in any text. Analyze by school we could find that the analytics school are mentioned a lot in other texts, which infers that philosophers like Russel conduct influential research to philosopher in other school. From corpus'  perspective, Aristotle is the school which produced the largest corpus in history of philosophy (by sentences length), which implies Aristotle's position in history is also not omittable since he create his own school (and only himself in this category).







